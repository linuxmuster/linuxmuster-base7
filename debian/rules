#!/usr/bin/make -f
# debian/rules for linuxmuster-base7
# Modernized to use pybuild and dh-python for Debian Python Policy compliance
# 20251113

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# Use pybuild for Python package building
export PYBUILD_NAME=linuxmuster-base7

%:
	dh $@ --with python3 --buildsystem=pybuild

override_dh_auto_clean:
	dh_auto_clean
	rm -rf build
	rm -rf src/*.egg-info
	find . -name __pycache__ -type d -exec rm -rf {} + 2>/dev/null || true
	find . -name "*.pyc" -delete

override_dh_auto_install:
	dh_auto_install
	# pybuild handles Python package installation automatically
	# Non-Python files (share/, etc/) are handled by debian/install
	# Move linuxmuster-* scripts from /usr/bin to /usr/sbin (root-only tools)
	mkdir -p debian/linuxmuster-base7/usr/sbin
	if [ -d debian/linuxmuster-base7/usr/bin ]; then \
		for script in debian/linuxmuster-base7/usr/bin/linuxmuster-*; do \
			if [ -f "$$script" ]; then \
				mv "$$script" debian/linuxmuster-base7/usr/sbin/; \
			fi \
		done \
	fi
